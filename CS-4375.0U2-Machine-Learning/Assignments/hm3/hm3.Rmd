---
output:
  word_document: default
  pdf_document: default
  html_document: default
---

Name: Alex Lundin
Assignment: HM3

Step 1
# Install the necessary package then load the library
```{r}
library(knitr)
# load library
if(!require('mlbench')){
  install.packages('mlbench')  
  library('mlbench')
}

```



# a. There are 699 instances

# b. The target column is Class

# c. There are 11 of predictors, here is all the information known:
# --------------------------------------------------------------
# Index  Name             Description                   Type
#[,1]	   Id               Sample code number            ord
#[,2]	   Cl.thickness     Clump Thickness               ord
#[,3]	   Cell.size        Uniformity of Cell Size       ord
#[,4]	   Cell.shape       Uniformity of Cell Shape      ord
#[,5]	   Marg.adhesion	  Marginal Adhesion             ord
#[,6]	   Epith.c.size	    Single Epithelial Cell Size   ord
#[,7]	   Bare.nuclei	    Bare Nuclei                   fctr
#[,8]	   Bl.cromatin	    Bland Chromatin               fctr
#[,9]	   Normal.nucleoli	Normal Nucleoli               fctr
#[,10]	 Mitoses	        Mitoses                       fctr
#[,11]	 Class	          Class                         fctr

# d. There are 344778254649499 percent malignant observances


Step 1: Investigate the Data following homework instructions

# Store BreastCancer data into a frame
# The investigate the BreakCancer data frame df with:
# str, head and summary on the class column
```{r}
df <- BreastCancer

# required r functions per homework doc
str(df)
head(df)
summary(df$Class)

# extra r functions to help me see the data
names(df)
summary(df)
```


# Calculate percentages
```{r}
# extract class column
classColumn <- df[,11]
summary(classColumn)

# create table from classColumn
myTable <- table(classColumn)

# extract counts from table
countMalignant <- myTable[names(myTable) == "malignant"]
countBenign <- myTable[names(myTable) == "benign"]

#calculate percentage
percentMalignant <- countMalignant / (countMalignant + countBenign)

#print to screen
paste("The percent of malignant observations is: ", percentMalignant)

```
 Step 2: Logistic Regression Model glm0
 
# Result of google search of warning message:
# https://stat.ethz.ch/pipermail/r-help/2008-March/156868.html
# Result of google search to fix warning message:
# https://stats.stackexchange.com/questions/11109/how-to-deal-with-perfect-separation-in-logistic-regression

# My analysis:
# From what I read, this message appears when the y responses are of the form 0 or 1 response
# From what this data set contains, that is exactly what the target class stores.
# A 0 for benign and a 1 for malignant
# To fix this, the second webpage reccomends two solutions:
# 1 use penalized logistic regression to remove bias
# 2 use Bayesian analysis (bayesglm)
```{r}
set.seed(1234)
i <- sample(1:nrow(df), 0.75*nrow(df))
train <- df[i,]
test <- df[-i,]
glm0 <- glm(Class~Cell.size+Cell.shape, data=train, family=binomial)
summary(glm0)
```



 
