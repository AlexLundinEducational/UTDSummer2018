Name: Alex Lundin
Assignment: Project 1

# Linear Regression

This data set is from the following URL:
https://archive.ics.uci.edu/ml/datasets/Heart+Disease

This study pulls various pieces of data from subjects to learn about factors related to heart disease.

14 attributes of the original 76 attributes were used in the processed data sets.

Complete attribute documentation:
(These are renumbered from the original website to match the trimed data)
1 age: age in years 
2 sex: sex (1 = male; 0 = female) 
3 cp: chest pain type 
-- Value 1: typical angina 
-- Value 2: atypical angina 
-- Value 3: non-anginal pain 
-- Value 4: asymptomatic 
4 trestbps: resting blood pressure (in mm Hg on admission to the hospital) 
5 chol: serum cholestoral in mg/dl 
6 fbs: (fasting blood sugar > 120 mg/dl) (1 = true; 0 = false) 
7 restecg: resting electrocardiographic results 
8 thalach: maximum heart rate achieved 
9 exang: exercise induced angina (1 = yes; 0 = no) 
10 oldpeak = ST depression induced by exercise relative to rest 
11 slope: the slope of the peak exercise ST segment 
-- Value 1: upsloping 
-- Value 2: flat 
-- Value 3: downsloping 
12 ca: number of major vessels (0-3) colored by flourosopy 
13 thal: 3 = normal; 6 = fixed defect; 7 = reversable defect 
14 num: diagnosis of heart disease (angiographic disease status) 
-- Value 0: < 50% diameter narrowing 
-- Value 1: > 50% diameter narrowing 
(in any major vessel: attributes 59 through 68 are vessels) 

# load the project data

```{r}


# different file locations for the project
dataPathHomeComputer <- "C:\\Users\\Alex\\Desktop\\Screen-Cleaner\\GitHub\\UTDSummer2018\\CS-4375.0U2-Machine-Learning\\Projects\\project1\\data\\processed.hungarian.data"

dataPathSchoolComputer <- "H:\\GitHub\\UTDSummer2018\\CS-4375.0U2-Machine-Learning\\Projects\\project1\\data\\processed.hungarian.data"

# create the dataframe for heart disease
df_hd <- read.table(dataPathSchoolComputer)

# sets the column names of the data frame with colnames function
colnames(df_hd) <- c("age", "sex", "cp", "trestbps", "chol", "fbs", "restecg", "thalach", "exang", "oldpeak", "slope", "ca", "thal", "num")



# separate out the train and test dataframes following a similar naming convention of original frame

# Set random seed to ensure reproducibility of the shuffle.
set.seed(1958)


# shuffle the df_hd and store into a new df_hd frame
df_hd_numberOfRows <- nrow(df_hd)
shuf_df_hd <- df_hd[sample(df_hd_numberOfRows), ]

# set train_data df_hd with the train_data indices
train_data_indices <- 1:round(0.75 * df_hd_numberOfRows)
train_data <- shuf_df_hd[train_data_indices, ]
# set test_data df_hd with the test_data indices
test_data_indices <- (round(0.75 * df_hd_numberOfRows) + 1):df_hd_numberOfRows
test_data <- shuf_df_hd[test_data_indices, ]

```


# investigate the data with names, str, head, summary and cor
```{r}
# look at the names of the data frame
nameArray <- names(df_hd)
printString <- "The names of the columns are:"

# print a useful message with a compact version of the columns using str
print(printString)
str(nameArray)

# show first 6 instances of the frame
head(df_hd)

```

The 4 main columns that correlate highly with a diagonois of heart disease are:
3   // cp        // chest pain
9   // exang     // exercise induced angina
10  // oldpeak   // ST depression induced by exercise relative to rest 
11  // slope     // slope of the peak exercise ST segment
all four of these have a correlation above .5 with the diagnois of heart disease in patients.
```{r}
# store a summary of the data frame
sm <- summary(df_hd)

# print the summary
print(sm)

# coerce all predictors and targets as numeric for correlation function

xPredictor <- as.numeric(df_hd$cp)
yTarget <- as.numeric(df_hd$num)

print("Correlation of -- Chest pain and heart disease:")
cor(xPredictor, yTarget)

xPredictor <- as.numeric(df_hd$exang)
print("Correlation of -- Exercise induced chest pain and heart disease:")
cor(xPredictor, yTarget)

xPredictor <- as.numeric(df_hd$oldpeak)
print("Correlation of -- ST depression, aka irregular heart beat, due to exercise and heart disease:")
cor(xPredictor, yTarget)

xPredictor <- as.numeric(df_hd$slope)
print("Correlation of -- Slope of ST depression during peak exercise and heart disease:")
cor(xPredictor, yTarget)
```

# two informative graphs
```{r}

```


# first model for heart disease
# This model uses exercise induced angina as the predictor for the target of a heart disease diagnosis
The model has:
Rsquared = .39
low pvalues for the predictor and target
low pvalue for the f-stastic

The rsquared value should be closer to 100%, but this dataset is attempting to predict something with alot of factors.
So the nature of this data explains why the rsquared value is low, it's complex.

When checking how the model does predicting on the test data.
There is a .69 correlation between the predicted value on the test data and the training model.
This model is a good represenation, not super duper, but pretty good.
I think this model performed well because the data set is suited for linear regression.
```{r}
# create linear model on train_data
train_lm1 <- lm(as.numeric(exang)~as.numeric(num), data=train_data)
print(train_lm1 )
plot(train_lm1)

# store a summary of the model created from the train data and print it
lm1_sm <- summary(train_lm1)
print(lm1_sm)

# attempt to predict the target y value of the test data with the train linear model
pred <- predict(train_lm1, newdata=test_data)
print("Correlation of -- Prediction of heart disease using training model with test data:")
cor(pred, as.numeric(test_data$exang))
```

# second model for heart disease
# this model uses knn clustering with columns 9 and 10
# exang and oldpeak to attempt to predict heart disease diagnosis based on those two predictors
correlation value of predictions vs actual: .66
this model was slightly less accurate than the regression model.
This data set is more suitable towards linear regression models, so I think that's why this model is less accurate since it uses classification when all of this data set is numeric type.
```{r}
# load auto_dataFrame
if(!require('caret')){
  install.packages('caret')  
  library('caret')
}
if(!require('DMwR')){
  install.packages('DMwR')  
  library('DMwR')
}

# create the second linear model for heart disease data
train_lm2 <- knnreg(train_data[,9:10], train_data[,14], cl, k=3)

# store a summary of the model created from the train data and print it
lm2_sm <- summary(train_lm2)
print(lm2_sm)

# correlate how well the model did
# do this by comparing the performace of the model using test data for columns 9 and 10
# which are exang and oldpeak
# the model used those to predict heart disease based on those factors
predictions <- predict(fit, test_data[,9:10])
# now correlate the predictions against the actual values in the test data
print("Correlation of -- Prediction of heart disease using training model with test data:")
cor(predictions, test_data$num)

```